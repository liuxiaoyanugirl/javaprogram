<!doctype html>
<html lang="en">
	<head>
        <meta charset="utf-8">
        <link rel ="stylesheet" href="css/bootstrap.css" >
        <link rel="stylesheet" href="css/jquery.page.css">
<!-- Main CSS -->
    <style>
        body{
            background: url("images/cloud.jpg") no-repeat;
            background-size: cover;
            width: 100%;
            height: 100%;
        }
        *{
            padding: 0;
            margin: 0;
        }
        /*标题样式*/
        .heaBac{
            width: 62%;
            height: 180px;
            margin: auto;
        }
        /*主盒子*/
        .mainBox {
            position: absolute;
            width:62%;
            top: 130px;
            left: 290px;
            height: 600px;
            background-color: #F8F8F8;
        }
        /*主导航*/
        .headBox{
            position: relative;
            width:100%;
            height: 110px;
            background-color: #E8E8E8;
        }
        .avater{
            position: relative;
            width: 140px;
            height: 140px;
            top: -40px;
            left: 20px;
            border: 4px solid lightskyblue;
            border-radius: 5px;
        }
        .text{
            position: relative;
            width: 300px;
            height: 100px;
            top: -140px;
            left: 180px;
        }
        .sideBox{
            position: relative;
            width: 20%;
            height:70%;
            top: 10px;
            list-style: none;
            background-color: #E8E8E8;
        }
        ul li{
            width: 100%;
            height: 50px;
            line-height: 50px;
            text-align: center;
            color:black;
            font-size: 20px;
        }
        ul li:hover{
            background-color: whitesmoke;
        }
        img{
            position: relative;
            top: 9px;
            left: -5px;
        }
        /*按钮盒子及样式*/
        .btn{
            position: relative;
            left: 300px;
            top: -40px;
            background-color: #9acfea;
        }
        /*内容盒子*/
        .publicBox{
            position: relative;
            width: 670px;
            height: 360px;
            left: 200px;
            top: -50px;
            background-color: whitesmoke;
        }
        .joinBox{
            position: relative;
            width: 670px;
            height: 360px;
            left: 200px;
            top: -50px;
            background-color:  whitesmoke;
        }
        .table{
            position: relative;
            top: -60px;
        }
    </style>
    </head>
    <body>
    <!-- Header content area -->
    <div class="heaBac">
    </div>
        <!-- Main content area -->
     <div class="mainBox">
         <div class="headBox">
             <div >
                 <img class="avater" src="images/tx.jpg"/>
             </div>
             <div class="text">
                 <p id="un"></p>
                 <p>男</p>
                 <p id="lb"></p>
                 <span id="ct"></span> <span id="sc"></span> <span id="xy"></span> <span id="zy"></span>
                 <button class="btn">编辑资料</button>
             </div>
         </div>
         <div>
             <ul  class="sideBox">
                 <li  class="public">
                     <p>我的发布</p>
                 </li>
                 <li  class="join">
                     <p >我的参与</p>
                 </li>
             </ul>

             <div class="publicBox">
                 <table class="table" id="tab">
                     <caption>我发布的帖子</caption>
                     <thead>
                     <tr>
                         <th>标题</th>
                         <th>类型</th>
                         <th>状态</th>
                         <th>操作</th>
                         <th>操作</th>
                     </tr>
                     </thead>
                     <tr id="template" >
                         <td id="actionName" class="tdc"></td>
                         <td id="label" class="tdc"></td>
                         <td id="date" class="tdc"></td>
                         <td><button >查看</button></td>
                         <td><button >删除</button></td>
                     </tr>
                 </table>
                 <p>
                     <button id="before">前一页</button>
                     <span>第<span id="pageN">3</span>/<span id="szs">3</span>页</span>
                     <button id="after">后一页</button>
                 </p>
             <div class="joinBox"> <table class="table">
                 <caption>我参与的帖子</caption>
                 <tr>
                     <th>标题</th>
                     <th>类型</th>
                     <th>状态</th>
                     <th>操作</th>
                     <th>操作</th>
                 </tr>

                 <tbody>
                 <tr class="active">
                     <td>产品2产品2产品2产品2产品2产品2</td>
                     <td>组对学习</td>
                     <td>申请中</td>
                     <td><button >查看</button></td>
                     <td><button >删除</button></td>
                 </tr>
                 </tbody>
             </table></div>
         </div>

        </div>
     </div>
    <script src="jquery.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function(){

            function setCookie(cname,cvalue) {
                var d=new Date();
                d.setTime(d.getTime()+7*24*60*60*1000);
                var expires="expires="+d.toGMTString();
                document.cookie=cname+"="+cvalue+";"+expires;
            }
            function getCookie(cname){
                var name=cname+"=";
                var ca=document.cookie.split(';');
                for (var i=0;i<ca.length;i++){
                    var c=ca[i].trim();
                    if(c.indexOf(name)==0){
                        return c.substring(name.length,c.length);
                    }
                }
            }

            // 选择出现隐藏
            $(".joinBox").hide();
            $(".join").click(function(){
                $(".joinBox").show().css("background-color","#9acfea");
                $(".publicBox").hide();
                $(".join").css("background-color","#9acfea");
                $(".public").css("background-color","lightgray");
            });
            $(".public").click(function(){
                $(".publicBox").show().css("background-color","#9acfea");
                $(".joinBox").hide();
                $(".public").css("background-color","#9acfea");
                $(".join").css("background-color","lightgray");
            });

            var test = getCookie("uname");
            $('#un').html(test);
            var user = {
                username: test,
            };
            var info = {
                username: test,
                pageNum:1,
                pageSize:5
            };
            console.log(info);

            function init() {


                $("#before").click(function(){
                    var test1=$("#pageN").val();
                    info.pageNum = test1-1;
                    //显示全部个人组队信息
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8888/studyInfo/getStudyInfoWithUserIssue", //这里写接口地址，
                        data: info, //调用时的参数
                        dataType: "json",//返回json
                        success: function(data){//成功
                            console.log(data);
                            $("#pageN").html(data.pageNum);
                            $("#szs").html(data.pages);
                            $("[id=ready]").remove();
                            // var data = eval("("+msg.responseText+")");
                            $.each(data, function(i, n){
                                var row = $("#template").clone();
                                row.find("#actionName").text(n.actionName);
                                row.find("#label").text(n.label);
                                row.find("#date").text(n.date);
                                row.attr("id","ready");//改变绑定好数据的行的id
                                row.appendTo("#tab");//添加到模板的容器中
                            });
                            // $("[id=ready]").show();
                        }
                    });

                });
                $("#after").click(function(){
                    var test2=$("#pageN").val();
                    info.pageNum = test2+1;
                    console.log(info.pageNum)
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8888/studyInfo/getStudyInfoWithUserIssue", //这里写接口地址，
                        data: info, //调用时的参数
                        dataType: "json",//返回json
                        success: function(data){//成功
                            console.log(data);
                            $("#pageN").html(data.pageNum);
                            $("#szs").html(data.pages);
                            $("[id=ready]").remove();
                            // var data = eval("("+msg.responseText+")");
                            $.each(data, function(i, n){
                                var row = $("#template").clone();
                                row.find("#actionName").text(n.actionName);
                                row.find("#label").text(n.label);
                                row.find("#date").text(n.date);
                                row.attr("id","ready");//改变绑定好数据的行的id
                                row.appendTo("#tab");//添加到模板的容器中
                            });
                            // $("[id=ready]").show();
                        }
                    });
                });

                    //显示全部个人组队信息
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8888/studyInfo/getStudyInfoWithUserIssue", //这里写接口地址，
                        data: info, //调用时的参数
                        dataType: "json",//返回json
                        success: function(data){//成功
                            console.log(data);
                            $("#pageN").html(data.pageNum);
                            $("#szs").html(data.pages);
                            var str = "";//定义用于拼接的字符串
                            for (var i = 0; i < data.size; i++) {
                                //拼接表格的行和列
                                str = "<tr ><td>" + data.list[i].actionName + "</td><td>" + data.list[i].data + "</td><td>"+data.list[i].actionName+"</td> <td><button >查看</button></td> <td><button >删除</button></td></tr>";
                                //追加到table中
                                $("#tab").append(str);
                            }
                        }
                    });
                //显示个人信息
                $.ajax({
                    type: "GET",
                    contentType: "application/json",
                    url: "http://localhost:8888/userInfo/getUserInfo", //这里写接口地址，
                    data: user, //调用时的参数
                    dataType: "json",//返回json
                    success: function (data) {//成功
                        $('#un').html(data.username);
                        $('#lb').html(data.personalizedLabels);
                        $('#sc').html(data.school);
                        $('#xy').html(data.academy);
                        $('#zy').html(data.major);
                        $('#ct').html(data.city);
                    }
                });

            }
            init();    // 调用


        });

    </script>
    </body>

</html>